<!DOCTYPE html>
<html>

    <head>
        <meta name="description" content="This is a sample for my self-education." />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <link href="../../css-shared/styles/bulma.css" rel="stylesheet" />

        <style>
            #audio-player-container {
                border: solid 2px;
                border-radius: 8px;
                margin: 1rem auto;
                width: 25rem;
            }

            #audio-player-container>#play-pause-block>button {
                background: none;
                border: none;
                cursor: pointer;
            }

            #audio-player-container>#play-pause-block>button>svg>use {
                opacity: 0;
            }
        </style>

        <title>the `input[type="range"]` element: play/pause control</title>
    </head>

    <body class="container has-text-centered p-4">
        <h1 class="is-size-1 mb-4">the <code>input[type="range"] element</code>: play/pause control</h1>

        <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
            <symbol id="play">
                <polygon points="24,0 96,48 24,96" />
            </symbol>
            <symbol id="pause">
                <polygon points="12,0 36,0 36,96 12,96" />
                <polygon points="48,0 72,0 72,96 48,96" />
            </symbol>
        </svg>

        <div id="audio-player-container" class="p-3">
            <div id="play-pause-block" class="is-flex is-align-items-center">
                <button data-playing="false">
                    <svg class="svg-sprite" width="96" height="96">
                        <use id="play" xlink:href="#play"></use>
                        <use id="pause" xlink:href="#pause"></use>
                    </svg>
                </button>
                <input id="play-pause-range" name="volume" type="range" value=0 />
                <span class="is-flex is-flex-wrap-nowrap is-align-content-center pl-2">
                    <output id="play-pause-progress-output" for="play-pause-range" class="is-size-5 is-align-self-center">00:00</output>
                    <output id="play-pause-duration-output" for="play-pause-range" class="is-size-6 is-align-self-center">/00:00</output>
                </span>
            </div>
        </div>

        <p><small class="is-size-6">This sample is based on the very excellent article, “<a href="https://css-tricks.com/lets-create-a-custom-audio-player/">Let’s Create a Custom Audio Player</a>,” by Idorenyin Udoh.</p>
        <script>
            (() => {
                const rx = {
                    progressiveAudio: {
                        container: window.document.getElementById('audio-player-container'),
                        handlePlayPauseEvent: button => {
                            const dataset = button.dataset;

                            const playPauseBlock = rx.progressiveAudio.container.querySelector('#play-pause-block');
                            const playSprite = playPauseBlock.querySelector('button>svg>#play');
                            const pauseSprite = playPauseBlock.querySelector('button>svg>#pause');

                            if (button.dataset.playing === 'true') {
                                playSprite.style.opacity = '1';
                                pauseSprite.style.opacity = '0';

                                button.dataset.playing = 'false';
                            } else {
                                playSprite.style.opacity = '0';
                                pauseSprite.style.opacity = '1';

                                button.dataset.playing = 'true';
                            }
                        },
                        initializePlayPauseBlock: () => {
                            const playPauseBlock = rx.progressiveAudio.container.querySelector('#play-pause-block');
                            const playSprite = playPauseBlock.querySelector('button>svg>#play');
                            playSprite.style.opacity = '1';
                        }
                    }
                };

                const buttonForPlayPause = rx.progressiveAudio.container.querySelector('#play-pause-block>button');

                buttonForPlayPause.addEventListener('click', event => {
                    const button = event.target;
                    rx.progressiveAudio.handlePlayPauseEvent(button);
                });

                rx.progressiveAudio.initializePlayPauseBlock();
            })();
        </script>
    </body>

</html>